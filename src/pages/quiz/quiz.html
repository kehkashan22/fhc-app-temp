<ion-header>

  <ion-navbar  color="headerColor">
    <ion-title text-wrap>QUIZ</ion-title>
  </ion-navbar>

</ion-header>
<ion-content>
  <!--QUIZ DIV HERE-->
  <div *ngIf="question; else quizEnd;" [@myvisibility]="visibleState" class="results">

    <timer #timer [timeInSeconds]="60" (timeUp)="handleTimeUp($event)"></timer>


    <progress-bar [progress]="index+1" [total]="quizCollection?.length"></progress-bar>
    <ion-card>
      <ion-card-header><b>Question {{index + 1}}</b></ion-card-header>
      <ion-card-content>
        <div class="question">
          {{currentQuestion?.question}}
        </div>
      </ion-card-content>
    </ion-card>

    <ion-list radio-group mode="ios">
      <ion-item *ngFor="let answer of currentQuestion?.answers" mode="ios">

        <ion-label text-wrap>
          <ion-grid>
            <ion-row>
              <ion-col col-2>
                {{answer.answerKey}}.
              </ion-col>
              <ion-col text-wrap>
                {{answer.answerText}}
              </ion-col>
            </ion-row>
          </ion-grid>

        </ion-label>
        <ion-radio [value]="answer" (click)="changeQuestion(answer)" mode="ios" color="headerColor"></ion-radio>
      </ion-item>
    </ion-list>

  </div>

  <!--To Analysis-->
  <ng-template #quizEnd>
    <div *ngIf="results" class="results">
      <div id="quiz-bg"></div>
      <div id="content">
        <div id="quiz-info">
          <div id="quiz-image">
            <div [class]=getClassString(percentage)>
              <span>{{percentage}}%</span>
              <div class="slice">
                <div class="bar"></div>
                <div class="fill"></div>
              </div>
            </div>
          </div>
          <br>
          <span id="quiz-description"> Total Questions : {{quizCollection?.length}} </span>
          <br>
          <span id="quiz-description"> Correct Answers : {{marks}} </span>
          <br>
          <span id="quiz-description"> Incorrect Answers :{{quizCollection?.length - marks}}</span>
        </div>
      </div>

      <button ion-button block outline color="btn-login" (click)="toExplanation()">Get Full Analysis</button>
      <button ion-button block outline color="btn-login" (click)="toQuizList()">Back to Quiz List</button>
    </div>
    <!--EXPLANATION AND ANALYSIS HERE-->
    <div *ngIf="!results" [@myvisibility]="visibleState">
      <ion-grid>
        <ion-row>
          <ion-col align-self-start>
            <div *ngIf="secondQuestion">
              <ion-buttons left>
                <button ion-button icon-only clear small (click)="changeExplanation('previous')">
                  PREV
                  <!--<ion-icon name="md-arrow-round-back" item-left></ion-icon>-->
                </button>
              </ion-buttons>

            </div>
          </ion-col>
          <ion-col align-self-end>
            <div>
              <ion-buttons right>
                <button ion-button icon-only clear small (click)="changeExplanation('next')" item-right>
                 <!--<ion-icon name="md-arrow-round-forward" class="item-icon-right"></ion-icon>-->
                 NEXT
              </button>
              </ion-buttons>
            </div>
          </ion-col>
        </ion-row>
      </ion-grid>

      <progress-bar [progress]="progressIndex" [total]="quizCollection?.length"></progress-bar>
      <div>
        <ion-card>
          <ion-card-header>Question {{index+1}}</ion-card-header>
          <ion-card-content>
            <div class="question">
              {{answeredQuestion?.question}}
            </div>
          </ion-card-content>
        </ion-card>

        <ion-list radio-group mode="ios" id="solutions" class="results" no-lines>
          <ion-item *ngFor="let answer of answeredQuestion?.answers" mode="ios">
            <ion-grid id="resultGrid">
              <ion-row [ngClass]="getAnswerClass(answer)">
                <ion-col col-2 class="choices">
                  <div>
                    <span>
                         {{answer.answerKey}}.
                    </span>
                  </div>

                </ion-col>
                <ion-col class="choices">
                  <div>
                    <span text-wrap>
                    {{answer.answerText}}
                    </span>
                  </div>
                </ion-col>
                <ion-col col-2>
                  <ion-buttons right>
                    <button ion-button icon-only clear large>
                      <ion-icon name="md-close" *ngIf="answer.selected && !answer.correct" color="danger"></ion-icon>
                      <ion-icon name="md-checkmark" *ngIf="answer.correct" color="secondary" ></ion-icon>
                    </button>
                  </ion-buttons>
                </ion-col>
              </ion-row>
            </ion-grid>
          </ion-item>
        </ion-list>

        <ion-card>
          <ion-card-header>Explanation:</ion-card-header>
          <ion-card-content>
            {{answeredQuestion?.explanation}}
          </ion-card-content>
        </ion-card>
      </div>
    </div>

  </ng-template>
</ion-content>
